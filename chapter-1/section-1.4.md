## 1.4 클로저

React의 클래스형 컴포넌트가 자바스킓트의 클래스, 프로토타입, this에 달려있다면, 함수형 컴포넌트에 대한 이해는 클로저에 달려 있다.

### 1.4.1 클로저의 정의

MDN에서의 정의는 클로저는 아래와 같이 되어 있다.

```
"함수와 함수가 선언된 어휘적 환경(렉시컬 스코프)의 조합"
```

정의가 난해해서 명확히 이해하지 못하는 경우가 많다. React 함수형 컴포넌트와 훅이 등장하면서, 클로저라는 개념이 React 내부적으로 적극 활용되며 이를 모르고서는 작동 방식을 이해하기 어려워졌다.

먼저, "선언된 어휘적 환경"이라는 것은 어디에서 선언되었는지를 말하는 것이고 어느 함수의 내부에 선언된 inner 함수는 상위 함수의 변수에 접근할 수 있다는 이야기가 된다.

### 1.4.2 변수의 유효 범위, 스코프

클로저를 이해하기 위해서는 변수의 유효 범위 즉, 스코프(scope)를 알아야 한다.

#### 📌 전역 스코프

전역 레벨에 선언하는 것을 전역 스코프라고 한다. 브라우저 환경에서 전역 객체는 window, 노드 환경에서는 global이 있는데, 선언한 전역 변수는 이 객체에 바인딩된다.

```js
const global = "hello";
console.log(전역변수 === window.전역변수); // true
```

#### 📌 함수 스코프

자바스크립트는 기본적으로 함수 레벨 스코프를 따른다. 즉, {} 블록은 스코프 범위를 결정하지는 않는다.

```js
if (true) {
  var global = "global";
}
console.log(global === window.global); // true
```

하지만 이는 `var` 키워드의 경우고, `let`과 `const` 키워드는 블록 레벨을 따른다.

### 1.4.3 클로저의 활용

#### 📌 클로저의 활용

클로저를 활용하면 사용자가 직접 수정할 수 없도록 전역 스코프의 사용을 막고, 개발자가 원하는 정보만 원하는 방향으로 노출시킬 수있다.

#### 📌 리액트에서의 클로저

React에서의 대표적인 클로저 활용 예시는 `useState`다. useState 함수 호출은 보통 Component 첫 줄에서 종료되는데, `useState` 내부에서 클로저가 활용되기 때문에 최신 상태값을 계속해서 확인할 수 있다.

### 1.4.4 주의할 점

전역 변수를 사용하면 의도와 다르게 작동할 수 있어 지양하고, 블록 레벨인 `let`, `const`를 사용해야 한다. 이는 "함수와 함수가 선언된 어휘적 환경의 조합"을 주의 깊게 살펴야 한다는 뜻이다.

그리고 클로저 사용에는 비용이 든다. 생성될 때마다 그 환경을 기억해야 하기 때문에 추가로 비용이 발생한다.
